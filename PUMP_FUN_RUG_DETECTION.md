# pump.fun ä»£å¸ Rug Pull æ£€æµ‹å®Œæ•´è°ƒæ•´è¯´æ˜

## ğŸ“‹ é¡¹ç›®å®šä½

**æœ¬é¡¹ç›®ä»…æ”¯æŒ Solana é“¾ä¸Šçš„ pump.fun å‘è¡Œçš„ä»£å¸ï¼Œå…¶ä»–é“¾çš„ä»£å¸å‡ä¸æ”¯æŒã€‚**

## ğŸ“‹ è°ƒæ•´æ¦‚è¿°

æœ¬æ¬¡è°ƒæ•´ä¸ºç³»ç»Ÿæ·»åŠ äº†å®Œæ•´çš„ pump.fun ä»£å¸ Rug Pull æ£€æµ‹æ”¯æŒï¼Œè€ƒè™‘äº† pump.fun å¹³å°çš„ç‰¹æ®Šæœºåˆ¶ï¼ˆbonding curveã€è™šæ‹Ÿå‚¨å¤‡ç­‰ï¼‰ã€‚æ‰€æœ‰æ£€æµ‹é€»è¾‘ä»…é’ˆå¯¹ Solana é“¾ä¸Šçš„ pump.fun ä»£å¸ã€‚

## ğŸ”§ ä¸»è¦è°ƒæ•´å†…å®¹

### 1. **Rug Pull æ£€æµ‹é€»è¾‘** (`apps/api/src/services/blockchain.ts`)

#### æ–°å¢åŠŸèƒ½ï¼š
- âœ… **è‡ªåŠ¨è¯†åˆ« pump.fun ä»£å¸**ï¼šé€šè¿‡ chainId è‡ªåŠ¨åˆ¤æ–­ï¼ˆSolana = 101ï¼‰
- âœ… **ä¸“ç”¨æ£€æµ‹å‡½æ•°**ï¼š`checkPumpFunRugStatus()` ä¸“é—¨å¤„ç† pump.fun ä»£å¸

#### æ£€æµ‹æœºåˆ¶ï¼š

**Bonding Curve é˜¶æ®µæ£€æµ‹ï¼š**
- ç›‘æ§è™šæ‹Ÿ SOL å‚¨å¤‡ï¼ˆ`virtual_sol_reserves`ï¼‰
- æ£€æµ‹å‚¨å¤‡å¼‚å¸¸ä¸‹é™ï¼ˆ>80%ï¼‰
- åŸºäºè™šæ‹Ÿå‚¨å¤‡è®¡ç®—ä»·æ ¼å˜åŒ–
- æ£€æµ‹ä»·æ ¼æš´è·Œï¼ˆ>90%ï¼‰

**Raydium æ± é˜¶æ®µæ£€æµ‹ï¼š**
- æ£€æŸ¥ bonding curve å®ŒæˆçŠ¶æ€ï¼ˆ`complete` å­—æ®µï¼‰
- å¦‚æœå·²è¿ç§»åˆ° Raydiumï¼Œæ£€æµ‹æ± æµåŠ¨æ€§
- å¸‚å€¼é«˜ä½†æµåŠ¨æ€§ä½æ—¶æ ‡è®°ä¸ºå¯ç–‘

```typescript
// å…³é”®æ£€æµ‹é€»è¾‘
if (isComplete) {
  // æ£€æŸ¥ Raydium æ± æµåŠ¨æ€§
  if (raydiumStats && liq < 1000 && marketCap > 10000) {
    result.isRugged = true;
  }
} else {
  // æ£€æŸ¥ bonding curve è™šæ‹Ÿå‚¨å¤‡
  if (prevSolReserves > 1 && virtualSolReserves < prevSolReserves * 0.2) {
    result.isRugged = true;
  }
}
```

### 2. **é£é™©è¯„ä¼°æ¨¡å‹è°ƒæ•´** (`apps/api/src/services/actuarial-calculator.ts`)

#### æ–°å¢å‚æ•°ï¼š
- `isPumpFun: boolean` å‚æ•°æ·»åŠ åˆ°ä»¥ä¸‹å‡½æ•°ï¼š
  - `calculatePremiumRate()`
  - `calculateRiskScore()`
  - `calculateRugPullRisk()`

#### æƒé‡è°ƒæ•´ï¼ˆé’ˆå¯¹ pump.funï¼‰ï¼š

| æŒ‡æ ‡ | æ ‡å‡†ä»£å¸æƒé‡ | pump.fun æƒé‡ | è¯´æ˜ |
|------|------------|--------------|------|
| æµåŠ¨æ€§ | 30% | **35%** â¬†ï¸ | bonding curve é˜¶æ®µæ›´é‡è¦ |
| æŒå¸åˆ†å¸ƒ | 20% | **25%** â¬†ï¸ | é›†ä¸­åº¦é£é™©æ›´é«˜ |
| å®¡è®¡è¯„åˆ† | 20% | **10%** â¬‡ï¸ | pump.fun é€šå¸¸æ— å®¡è®¡ |
| å›¢é˜ŸéªŒè¯ | 15% | **10%** â¬‡ï¸ | åŒ¿åé¡¹ç›®å¸¸è§ |
| å¸‚å€¼ç¨³å®šæ€§ | 15% | **20%** â¬†ï¸ | é˜ˆå€¼é™ä½ï¼ˆ5ä¸‡ vs 100ä¸‡ï¼‰ |

#### å¸‚å€¼é˜ˆå€¼è°ƒæ•´ï¼š
- **æ ‡å‡†ä»£å¸**ï¼š< 100ä¸‡ç¾å…ƒ = é«˜é£é™©
- **pump.fun ä»£å¸**ï¼š< 5ä¸‡ç¾å…ƒ = é«˜é£é™©ï¼ˆæ›´ç¬¦åˆå®é™…æƒ…å†µï¼‰

### 3. **å®šæ—¶ä»»åŠ¡æ›´æ–°** (`apps/api/src/scheduled/index.ts`)

#### æ”¹è¿›å†…å®¹ï¼š
- âœ… è‡ªåŠ¨è¯†åˆ«é“¾ç±»å‹ï¼ˆSolana/BSC/Base/Ethereumï¼‰
- âœ… ç»Ÿä¸€ä½¿ç”¨ `checkRugStatus()` å‡½æ•°ï¼ˆå·²æ”¯æŒ pump.funï¼‰
- âœ… è‡ªåŠ¨è°ƒç”¨å¯¹åº”çš„æ£€æµ‹é€»è¾‘

```typescript
// è‡ªåŠ¨è¯†åˆ«é“¾ç±»å‹
const isPumpFun = token.chain === 'solana' || token.chain === '101';
const chainId = isPumpFun ? 101 : (token.chain === 'bsc' ? 56 : 1);

// ä½¿ç”¨ç»Ÿä¸€çš„æ£€æµ‹å‡½æ•°
const rugResult = await checkRugStatus(
  { tokenAddress: token.address, chainId },
  env
);
```

## ğŸ“Š æ£€æµ‹æŒ‡æ ‡å¯¹æ¯”

### æ ‡å‡†ä»£å¸ vs pump.fun ä»£å¸

| æ£€æµ‹æŒ‡æ ‡ | æ ‡å‡†ä»£å¸ | pump.fun ä»£å¸ | é€‚ç”¨æ€§ |
|---------|---------|--------------|--------|
| **ä»·æ ¼æš´è·Œ >90%** | âœ… é€‚ç”¨ | âœ… é€‚ç”¨ | ä¸¤ç§æœºåˆ¶éƒ½é€‚ç”¨ |
| **æµåŠ¨æ€§æ’¤èµ° >80%** | âœ… é€‚ç”¨ | âš ï¸ **éœ€è°ƒæ•´** | pump.fun éœ€æ£€æŸ¥è™šæ‹Ÿå‚¨å¤‡ |
| **æµåŠ¨æ€§è¯„åˆ†** | âœ… é€‚ç”¨ | âœ… é€‚ç”¨ | æƒé‡æ›´é«˜ï¼ˆ35%ï¼‰ |
| **æŒå¸åˆ†å¸ƒ** | âœ… é€‚ç”¨ | âœ… é€‚ç”¨ | æƒé‡æ›´é«˜ï¼ˆ25%ï¼‰ |
| **å®¡è®¡è¯„åˆ†** | âœ… é€‚ç”¨ | âš ï¸ **éƒ¨åˆ†é€‚ç”¨** | æƒé‡é™ä½ï¼ˆ10%ï¼‰ |
| **å›¢é˜ŸéªŒè¯** | âœ… é€‚ç”¨ | âš ï¸ **éƒ¨åˆ†é€‚ç”¨** | æƒé‡é™ä½ï¼ˆ10%ï¼‰ |
| **å¸‚å€¼ç¨³å®šæ€§** | âœ… é€‚ç”¨ | âš ï¸ **éœ€è°ƒæ•´** | é˜ˆå€¼é™ä½ï¼ˆ5ä¸‡ vs 100ä¸‡ï¼‰ |

## ğŸ” æ–°å¢æ£€æµ‹èƒ½åŠ›

### 1. Bonding Curve è™šæ‹Ÿå‚¨å¤‡ç›‘æ§
```typescript
// æ£€æŸ¥è™šæ‹Ÿ SOL å‚¨å¤‡æ˜¯å¦å¼‚å¸¸ä¸‹é™
if (prevSolReserves > 1 && virtualSolReserves < prevSolReserves * 0.2) {
  result.rugIndicators.liquidityRemoved = true;
  result.isRugged = true;
}
```

### 2. å®ŒæˆçŠ¶æ€æ£€æµ‹
```typescript
// æ£€æŸ¥æ˜¯å¦å®Œæˆ bonding curve å¹¶è¿ç§»åˆ° Raydium
const isComplete = tokenData.complete === true;
if (isComplete && tokenData.raydium_pool) {
  // æ£€æŸ¥ Raydium æ± æµåŠ¨æ€§
}
```

### 3. ä¸¤é˜¶æ®µæ£€æµ‹
- **é˜¶æ®µ1**ï¼šBonding curve é˜¶æ®µï¼ˆè™šæ‹Ÿå‚¨å¤‡æ£€æµ‹ï¼‰
- **é˜¶æ®µ2**ï¼šRaydium æ± é˜¶æ®µï¼ˆæ ‡å‡†æµåŠ¨æ€§æ£€æµ‹ï¼‰

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### è°ƒç”¨ Rug Pull æ£€æµ‹
```typescript
import { checkRugStatus } from './services/blockchain';

// è‡ªåŠ¨è¯†åˆ« pump.fun ä»£å¸
const result = await checkRugStatus(
  { 
    tokenAddress: 'TokenMintAddress...', 
    chainId: 101  // Solana = pump.fun
  },
  env
);

if (result.isRugged) {
  console.log('Rug detected!', result.rugIndicators);
}
```

### è®¡ç®—ä¿è´¹ç‡ï¼ˆè€ƒè™‘ pump.funï¼‰
```typescript
import { actuarialCalculator } from './services/actuarial-calculator';

const result = actuarialCalculator.calculatePremiumRate(
  'rug_pull',
  riskFactors,
  true  // isPumpFun = true
);
```

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **é“¾ ID è¯†åˆ«**ï¼š
   - Solana mainnet: `101` æˆ– `0x65`
   - ç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«å¹¶åº”ç”¨å¯¹åº”çš„æ£€æµ‹é€»è¾‘

2. **æ•°æ®ç¼“å­˜**ï¼š
   - pump.fun ä»£å¸çŠ¶æ€ç¼“å­˜ 1 å°æ—¶
   - è™šæ‹Ÿå‚¨å¤‡æ•°æ®ç”¨äºå¯¹æ¯”æ£€æµ‹

3. **API ä¾èµ–**ï¼š
   - pump.fun API: `https://frontend-api.pump.fun`
   - DexScreener API: ç”¨äº Raydium æ± æ£€æµ‹

4. **å‘åå…¼å®¹**ï¼š
   - æ‰€æœ‰ç°æœ‰ä»£ç æ— éœ€ä¿®æ”¹
   - `isPumpFun` å‚æ•°ä¸ºå¯é€‰ï¼Œé»˜è®¤ä¸º `false`
   - æ ‡å‡†ä»£å¸æ£€æµ‹é€»è¾‘ä¿æŒä¸å˜

## âœ… æµ‹è¯•å»ºè®®

1. **æµ‹è¯• pump.fun ä»£å¸æ£€æµ‹**ï¼š
   - ä½¿ç”¨çœŸå®çš„ pump.fun ä»£å¸åœ°å€
   - éªŒè¯ bonding curve é˜¶æ®µæ£€æµ‹
   - éªŒè¯ Raydium æ± é˜¶æ®µæ£€æµ‹

2. **æµ‹è¯•é£é™©è¯„ä¼°**ï¼š
   - å¯¹æ¯”æ ‡å‡†ä»£å¸å’Œ pump.fun ä»£å¸çš„é£é™©è¯„åˆ†
   - éªŒè¯æƒé‡è°ƒæ•´æ˜¯å¦æ­£ç¡®

3. **æµ‹è¯•å®šæ—¶ä»»åŠ¡**ï¼š
   - éªŒè¯å®šæ—¶ä»»åŠ¡èƒ½æ­£ç¡®è¯†åˆ«é“¾ç±»å‹
   - éªŒè¯æ£€æµ‹ç»“æœæ­£ç¡®å†™å…¥æ•°æ®åº“

## ğŸ”„ åç»­ä¼˜åŒ–å»ºè®®

1. **æ·»åŠ æ›´å¤š pump.fun ç‰¹å®šæŒ‡æ ‡**ï¼š
   - æ£€æŸ¥ bonding curve å®Œæˆæ—¶é—´
   - ç›‘æ§ Raydium è¿ç§»æˆåŠŸç‡
   - åˆ†æç¤¾åŒºæ´»è·ƒåº¦ï¼ˆreply_countï¼‰

2. **ä¼˜åŒ–æ£€æµ‹é¢‘ç‡**ï¼š
   - pump.fun ä»£å¸å¯èƒ½éœ€è¦æ›´é¢‘ç¹çš„æ£€æµ‹ï¼ˆæ¯ 15 åˆ†é’Ÿï¼‰
   - bonding curve é˜¶æ®µå˜åŒ–è¾ƒå¿«

3. **æ·»åŠ é¢„è­¦æœºåˆ¶**ï¼š
   - è™šæ‹Ÿå‚¨å¤‡ä¸‹é™ >50% æ—¶å‘é€é¢„è­¦
   - ä»·æ ¼æ³¢åŠ¨å¼‚å¸¸æ—¶é€šçŸ¥ç”¨æˆ·

---

**æ›´æ–°æ—¶é—´**ï¼š2024-12-19  
**ç‰ˆæœ¬**ï¼šv1.0.0
